<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LifeLink ‚Äî Hospital Dashboard</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <!-- Sidebar Navigation -->
      <aside class="sidebar">
        <div class="logo">
          <div class="logo-icon">
            <img src="../bloodBank/logo.png" alt="logo" style="width: 40px" />
          </div>
          <h2>LifeLink</h2>
          <p class="tagline">Hospital Dashboard</p>
        </div>

        <nav class="nav-menu">
          <ul>
            <li class="nav-item active" data-page="dashboard">
              <i class="fas fa-home"></i>
              <span>Dashboard</span>
            </li>
            <li class="nav-item" data-page="emergency-requests">
              <i class="fas fa-exclamation-triangle"></i>
              <span>Emergency Requests</span>
            </li>
            <li class="nav-item" data-page="donor-list">
              <i class="fas fa-users"></i>
              <span>Donor List</span>
            </li>
            <li class="nav-item" data-page="blood-inventory">
              <i class="fas fa-tint"></i>
              <span>Blood Inventory</span>
            </li>
            <li class="nav-item" data-page="settings">
              <i class="fas fa-cog"></i>
              <span>Settings</span>
            </li>
            <li class="nav-item logout">
              <i class="fas fa-sign-out-alt"></i>
              <span onclick="logout()" style="cursor: pointer">Logout</span>
            </li>
          </ul>
        </nav>

        <div class="hospital-info">
          <p><i class="fas fa-hospital"></i> General Hospital</p>
          <p><i class="fas fa-map-marker-alt"></i>Madhya Pradesh, India </p>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="main-content">
        <!-- Top Navbar -->
        <header class="top-nav">
          <div class="page-title">
            <h1>Dashboard</h1>
            <p>Welcome to LifeLink Hospital Dashboard</p>
          </div>
          <div class="user-info">
            <div class="user-avatar">
              <i class="fas fa-user-md"></i>
            </div>
            <div class="user-details">
              <span class="user-name">Dr. Sarah Miller</span>
              <span class="user-role">Hospital Admin</span>
            </div>
          </div>
        </header>

        <!-- Content Pages -->
        <div class="content-area">
          <!-- Dashboard Page (Default) -->
          <section id="dashboard" class="page active">
            <div class="page-header">
              <h2>Quick Overview</h2>
              <p>Monitor emergency requests, donors, and blood inventory</p>
            </div>

            <div class="stats-cards">
              <div class="stat-card">
                <div
                  class="stat-icon"
                  style="background-color: rgba(230, 57, 70, 0.1)"
                >
                  <i
                    class="fas fa-exclamation-circle"
                    style="color: #e63946"
                  ></i>
                </div>
                <div class="stat-info">
                  <h3>Active Emergencies</h3>
                  <p class="stat-number">3</p>
                  <p class="stat-desc">Requests pending</p>
                </div>
              </div>

              <div class="stat-card">
                <div
                  class="stat-icon"
                  style="background-color: rgba(69, 123, 157, 0.1)"
                >
                  <i class="fas fa-users" style="color: #457b9d"></i>
                </div>
                <div class="stat-info">
                  <h3>Available Donors</h3>
                  <p class="stat-number">42</p>
                  <p class="stat-desc">Within 10km radius</p>
                </div>
              </div>

              <div class="stat-card">
                <div
                  class="stat-icon"
                  style="background-color: rgba(42, 157, 143, 0.1)"
                >
                  <i class="fas fa-tint" style="color: #2a9d8f"></i>
                </div>
                <div class="stat-info">
                  <h3>Blood Inventory</h3>
                  <p class="stat-number">8</p>
                  <p class="stat-desc">Types monitored</p>
                </div>
              </div>

              <div class="stat-card">
                <div
                  class="stat-icon"
                  style="background-color: rgba(233, 196, 106, 0.1)"
                >
                  <i class="fas fa-check-circle" style="color: #e9c46a"></i>
                </div>
                <div class="stat-info">
                  <h3>Resolved Today</h3>
                  <p class="stat-number">7</p>
                  <p class="stat-desc">Emergency requests</p>
                </div>
              </div>
            </div>

            <div class="dashboard-actions">
              <div class="action-card">
                <h3>Send Emergency SOS</h3>
                <p>Request urgent blood supply from donors and blood banks</p>
                <button class="btn-action" id="open-sos-btn">
                  <i class="fas fa-plus"></i> Create SOS Request
                </button>
              </div>

              <div class="action-card">
                <h3>Recent Emergency Requests</h3>
                <div class="recent-requests">
                  <div class="request-item">
                    <div class="request-info">
                      <span class="request-id">#ER-0042</span>
                      <span class="blood-group">O+</span>
                      <span class="urgency high">High Urgency</span>
                    </div>
                    <span class="request-time">15 min ago</span>
                  </div>
                  <div class="request-item">
                    <div class="request-info">
                      <span class="request-id">#ER-0041</span>
                      <span class="blood-group">B-</span>
                      <span class="urgency medium">Medium Urgency</span>
                    </div>
                    <span class="request-time">1 hour ago</span>
                  </div>
                  <div class="request-item">
                    <div class="request-info">
                      <span class="request-id">#ER-0040</span>
                      <span class="blood-group">AB+</span>
                      <span class="urgency low">Low Urgency</span>
                    </div>
                    <span class="request-time">3 hours ago</span>
                  </div>
                </div>
                <button class="btn-view-all" data-page="emergency-requests">
                  View All Requests <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </div>
          </section>

          <!-- Emergency Requests Page -->
          <section id="emergency-requests" class="page">
            <div class="page-header">
              <h2>Emergency Requests</h2>
              <p>Manage incoming SOS requests from your hospital</p>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Request ID</th>
                    <th>Blood Group</th>
                    <th>Units Needed</th>
                    <th>Time</th>
                    <th>Status</th>
                    <th>Accepted Donors</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Sample data will be populated by JS -->
                </tbody>
              </table>
            </div>

            <div class="empty-state" id="no-requests">
              <i class="fas fa-exclamation-triangle"></i>
              <h3>No Emergency Requests</h3>
              <p>There are no active emergency requests at the moment.</p>
            </div>
          </section>

          <!-- Donor List Page -->
          <section id="donor-list" class="page">
            <div class="page-header">
              <h2>Nearby Donors</h2>
              <p>Available blood donors within 15km radius</p>
              <div class="filter-options">
                <select id="blood-group-filter">
                  <option value="all">All Blood Groups</option>
                  <option value="A+">A+</option>
                  <option value="A-">A-</option>
                  <option value="B+">B+</option>
                  <option value="B-">B-</option>
                  <option value="O+">O+</option>
                  <option value="O-">O-</option>
                  <option value="AB+">AB+</option>
                  <option value="AB-">AB-</option>
                </select>
                <select id="availability-filter">
                  <option value="all">All Availability</option>
                  <option value="available">Available Now</option>
                  <option value="soon">Available Soon</option>
                </select>
              </div>
            </div>

            <div class="donor-grid">
              <!-- Sample data will be populated by JS -->
            </div>
          </section>

          <!-- Blood Inventory Page -->
          <section id="blood-inventory" class="page">
            <div class="page-header">
              <h2>Blood Inventory</h2>
              <p>Current blood stock status (read-only)</p>
            </div>

            <div class="inventory-grid">
              <!-- Sample data will be populated by JS -->
            </div>

            <div class="inventory-legend">
              <div class="legend-item">
                <span class="status-dot adequate"></span>
                <span>Adequate: 20+ units</span>
              </div>
              <div class="legend-item">
                <span class="status-dot low"></span>
                <span>Low: 5-19 units</span>
              </div>
              <div class="legend-item">
                <span class="status-dot critical"></span>
                <span>Critical: <5 units></span>
              </div>
            </div>
          </section>

          <!-- Settings Page -->
          <section id="settings" class="page">
            <div class="page-header">
              <h2>Hospital Settings</h2>
              <p>Manage your hospital profile and contact information</p>
            </div>

            <div class="settings-form-container">
              <form id="hospital-settings-form">
                <div class="form-group">
                  <label for="hospital-name">Hospital Name</label>
                  <input
                    type="text"
                    id="hospital-name"
                    value="General Hospital"
                    required
                  />
                </div>

                <div class="form-group">
                  <label for="hospital-address">Address</label>
                  <textarea id="hospital-address" rows="3" required>
MP Nagar, Bhopal, Madhya Pradesh ‚Äì 462011, India</textarea>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="contact-number">Contact Number</label>
                    <input
                      type="tel"
                      id="contact-number"
                      value="+91 8100665985"
                      required
                    />
                  </div>

                  <div class="form-group">
                    <label for="emergency-helpline">Emergency Helpline</label>
                    <input
                      type="tel"
                      id="emergency-helpline"
                      value="1008 2369 8456"
                      required
                    />
                  </div>
                </div>

                <div class="form-actions">
                  <button
                    type="button"
                    class="btn-secondary"
                    id="reset-settings"
                  >
                    Reset
                  </button>
                  <button type="submit" class="btn-primary">
                    Save Changes
                  </button>
                </div>
              </form>
            </div>
          </section>
        </div>
      </main>
    </div>

    <!-- Floating SOS Button -->
    <button class="sos-button" id="floating-sos-btn">
      <i class="fas fa-plus"></i>
      <span>SOS</span>
    </button>

    <!-- SOS Modal -->
    <div class="modal-overlay" id="sos-modal">
      <div class="modal">
        <div class="modal-header">
          <h2>Send Emergency SOS</h2>
          <button class="close-modal" id="close-sos-modal">&times;</button>
        </div>

        <form id="sos-form">
          <div class="form-group">
            <label for="blood-group">Required Blood Group *</label>
            <select id="blood-group" required>
              <option value="">Select Blood Group</option>
              <option value="A+">A+</option>
              <option value="A-">A-</option>
              <option value="B+">B+</option>
              <option value="B-">B-</option>
              <option value="O+">O+</option>
              <option value="O-">O-</option>
              <option value="AB+">AB+</option>
              <option value="AB-">AB-</option>
            </select>
          </div>

          <div class="form-group">
            <label for="units-needed">Units Needed *</label>
            <input
              type="number"
              id="units-needed"
              min="1"
              max="50"
              value="2"
              required
            />
          </div>

          <div class="form-group">
            <label for="urgency-level">Urgency Level *</label>
            <div class="urgency-options">
              <label class="urgency-option">
                <input type="radio" name="urgency" value="low" checked />
                <span class="urgency-badge low">Low</span>
              </label>
              <label class="urgency-option">
                <input type="radio" name="urgency" value="medium" />
                <span class="urgency-badge medium">Medium</span>
              </label>
              <label class="urgency-option">
                <input type="radio" name="urgency" value="high" />
                <span class="urgency-badge high">High</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="additional-notes">Additional Notes</label>
            <textarea
              id="additional-notes"
              rows="3"
              placeholder="Any specific requirements or details..."
            ></textarea>
          </div>

          <div class="modal-actions">
            <button type="button" class="btn-secondary" id="cancel-sos">
              Cancel
            </button>
            <button type="submit" class="btn-sos">
              <i class="fas fa-exclamation-triangle"></i> Send SOS Request
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast" id="notification-toast">
      <div class="toast-content">
        <i class="fas fa-check-circle"></i>
        <div class="toast-message">SOS request sent successfully!</div>
      </div>
    </div>

    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="script.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const role = localStorage.getItem("role");

        console.log("ROLE =", role); // üîç DEBUG

        if (role !== "hospital") {
          alert("Access denied");
          window.location.replace("/auth/login.html");
        }
      });
    </script>
  </body>
</html>
